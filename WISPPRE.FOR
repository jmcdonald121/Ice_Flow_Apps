CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC00000010
C                                                                      C00000020
C       *INTERACTIVE PREDOP*               (11/27/87) (MAINFRAMEE)     C00000030
C                                          (11/24/89) (IBM PC-AT)      C
C                                                                      C00000040
C       THIS PROGRAM CREATES THE INPUT FILE TO RUN THE PREDOP          C00000050
C       SOFTWARE PROGRAM OF THE GEODOP V SYSTEM.  THE EXECUTION OF     C00000060
C       THIS FORTRAN PROGRAM WILL PROMPT THE USER TO INPUT DATA FROM   C00000070
C       THE KEYBOARD.  THE DATA IS THEN WRITTEN TO THE FILE, *PR.INP.  C00000080
C       THIS FILE IS THEN USED TO INPUT PARAMETERS TO THE PROGRAM      C
C       PREDOP.EXE                                                     C
C          THE PREDOP SOFTWARE PROGRAM READS, ONE SATELLITE PASS AT A  C00000110
C       TIME, THE MAJORITY VOTED DOPPLER DATA.  THEN THE PROGRAM: A)   C00000120
C       CALULATES THE FIRST ORDER IONOSPHERIC REFRACTION CORRECTION;   C
C       B) COMPUTES THE SATELLITE ORBIT FROM THE BROADCAST DATA; C)    C
C       COMPARES THE DOPPLER COUNTS TO THEORETICAL VALUES AND EDITS    C
C       THEM ACCORDINGLY (PER PASS); E) OUTPUTS (WRITES) THE PASS TO A C
C       DATASET IN PREDOP-LIKE (BINARY) FORM WITH THE INPUTED          C
C       METEOROLOGIC DATA.  THE INPUTTED DATA IS EITHER RAW MX1502     C
C       DATA (WHICH IS MAJORITY VOTED BY THE RECEIVER) OR MAJORITY     C
C       VOTED JMR DATA GENERATED BY THE PROGRAMS MVOTG AND REFJMR.     C00000210
C          THIS IS THE IBM PC-AT VERSION OF THE MAINFRAME PROGRAM.     C
C       THIS PROGRAM HAS BEEN ALTERED SO IT CAN ONLY PROCESS THE       C
C       TRANSIT DATA IN THE POINT POSITIONING MODE.                    C
C          ALL OF THE VARIABLE NAMES USED FOR WRITING TO THE PREDOP    C
C       INPUT FILE CORRESPOND TO THE INTERNAL VARIABLE NAMES IN        C
C       THE PREDOP FORTRAN SOURCE CODE (SEE REFERENCE BELOW)           C
C                                                                      C00000220
C       REFERENCES:                                                    C00000230
C         1. ARCHINAL, B.A., 1986.  DOCUMENTATION FOR THE IBM VERSION  C00000240
C              OF THE GEODOP V PROGRAM SYSTEM.  UNPUBLISHED.           C00000250
C              DEPARTMENT OF GEODETIC SCIENCE AND SURVEYING            C00000260
C                                                                      C00000270
C         2. KOUBA, J. AND J.D. BOAL.  1976.  PROGRAM GEODOP.          C
C              DEPARTMENT OF ENERGY, MINES AND RESOURCES, OTTAWA,      C
C              ONTARIO. (N.B.: NOW A PART OF THE CANADIAN GEOLOGIC     C
C              SURVEY)                                                 C
C                                                                      C
C       JAMES MCDONALD                                                 C00000280
C       BYRD POLAR RESEARCH CENTER                                     C00000290
C       O.S.U.                                                         C00000300
C       COLUMBUS, OHIO  43210                                          C00000310
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC00000320
      IMPLICIT REAL*8(A-H,O-Z)
      CHARACTER*1 ISTN,PRFILE(6),MRFILE(6),OTFILE(6),BIN(6),DES,TEST
      CHARACTER*4 IMET,TMM,LOCT                                         00000330
      CHARACTER*30 INPTPR,INPTMR,OTPTPR,INDATA,PENAME,METFIL
      COMMON /A/ ISTN(30),PSTN(7),NUMMET,IRCV,TIME,IMET,CDOP,CELV,SIGC
      COMMON /B/ SIGF,ANOT,BNOT,K(1000),M(1000),J(1000),TDRY(1000)
      COMMON /C/ TWET(1000),IRH(1000),PRES(1000),LOCT,INPTPR,INPTMR
      COMMON /D/ OTPTPR,INDATA,X,Y,Z,PENAME(17),NUMSAT,ILIM(6),ISWT,
     4           KSAT(6),PHI,XLM
      DATA TMM/' '/,PRFILE/'P','R','.','I','N','P'/,                    00000390
     1              MRFILE/'M','R','.','I','N','P'/,
     2              OTFILE/'P','R','.','T','E','X'/,
     3              BIN/'.','B','I','N',' ',' '/
      DATA TEST/'Y'/
      LOCT=TMM                                                          00000400
C------INPUT THE SITE NAME---------------------------------------------C00000640
83    WRITE(0,100)                                                      00000650
100   FORMAT(' ','TYPE IN THE BINARY FILE NAME (UP TO 6 CHARACTERS AND N
     1O EXTENSION).',/)                                                 00000660
      READ(0,101) (ISTN(I),I=1,30)                                      00000670
101   FORMAT(30A1)                                                      00000680
      WRITE(0,102) (ISTN(I),I=1,30)                                     00000690
102   FORMAT(' ',/,6X,30A1,/)                                           00000700
      DO 1 I=1,30
         IF(ISTN(I).EQ.LOCT) GOTO 2
1     CONTINUE
2     I=I-1
      DO 3 II=1,I
         INPTPR(II:30)=ISTN(II)
         INPTMR(II:30)=ISTN(II)
         OTPTPR(II:30)=ISTN(II)
         INDATA(II:30)=ISTN(II)
3     CONTINUE
      DO 4 II=1,6
         INPTPR(I+II:30)=PRFILE(II)
         INPTMR(I+II:30)=MRFILE(II)
         OTPTPR(I+II:30)=OTFILE(II)
         INDATA(I+II:30)=BIN(II)
4     CONTINUE
C-------SITE COORDINATES-----------------------------------------------C00000710
      WRITE(0,103)                                                      00000720
103   FORMAT(' ','TYPE IN THE STATION LATITUDE WITH DEGREES, MINUTES, AN00000730
     1D SECONDS SEPARATED',/,1X,'BY A SPACE.  IF SOUTHERN HEMISPHERE, IN00000740
     2CLUDE A - SIGN IN FRONT OF EVERY',/,1X,'DEGREE, MINUTE, AND SECOND00000750
     3.',/)                                                             00000760
      READ(0,*) (PSTN(I),I=1,3)                                         00000770
      WRITE(0,104) (PSTN(I),I=1,3)                                      00000780
104   FORMAT(' ',/,6X,F5.0,1X,F4.0,1X,F4.0,/)                           00000790
      WRITE(0,105)                                                      00000800
105   FORMAT(' ','TYPE IN THE STATION LONGITUDE, WITH DEGREES, MINUTES, 00000810
     1AND SECONDS SEPARATED',/,1X,'BY A SPACE.  IF WESTERN HEMISPHERE IN00000820
     2CLUDE A - SIGN IN FRONT OF EVERY',/,1X,'DEGREE, MINUTE, AND SECOND00000830
     3.',/)                                                             00000840
      READ(0,*) (PSTN(I),I=4,6)                                         00000850
      WRITE(0,106) (PSTN(I),I=4,6)                                      00000860
106   FORMAT(' ',/,6X,F5.0,1X,F4.0,1X,F4.0,/)                           00000870
      WRITE(0,107)                                                      00000880
107   FORMAT(' ','TYPE IN THE STATION ELEVATION (METERS).',/)           00000890
      READ(0,*) PSTN(7)                                                 00000900
      WRITE(0,108) PSTN(7)                                              00000910
108   FORMAT(' ',/,6X,F7.1,/)                                           00000920
C-------ELLIPSOID PARAMETERS-------------------------------------------C
      WRITE(0,236)
236   FORMAT(' ','REFERENCE ELLIPSOID',/,3X,'1   WGS-66  [DEFAULT]',/,3X
     1,'2   WGS-72',/,3X,'3   WGS-84',/,3X,'4   INPUT VALUES FROM THE KE
     2YBOARD',/)
      READ(0,59) IELLIP
59    FORMAT(I1)
      IF(IELLIP.LT.1) IELLIP=1
      GOTO(60,61,62,63),IELLIP
60       ANOT=145.0D0
         BNOT=759.77D0
         WRITE(0,50) 
50       FORMAT(' ',/,6X,'1   WGS-66',/)
         GOTO 64
61       ANOT=135.0D0
         BNOT=750.50D0
         WRITE(0,51) 
51       FORMAT(' ',/,6X,'2   WGS-72',/)
         GOTO 64
62       ANOT=137.00D0
         BNOT=752.314D0
         WRITE(0,52)
52       FORMAT(' ',/,6X,'3   WGS-84',/)
         GOTO 64
63       WRITE(0,237)                                                   00003690
237      FORMAT(' ','TYPE IN THE REFERENCE ELLIPSIOD SEMI-MAJOR AXIS - 6
     1378000 (METERS).  DEFAULT IS NWL-9D (WGS 66) ELLIPSOID',/)        00003710
         READ(0,*) ANOT                                                 00003720
         WRITE(0,240) ANOT
240      FORMAT(' ',/,6X,'A=',F7.3,/)
         WRITE(0,239)                                                   00003740
 239     FORMAT(' ','TYPE IN THE REFERENCE ELLIPSIOD SEMI-MINOR AXIS - 6
     1356000 METERS (METERS).  DEFAULT IS NWL-9D (WGS-66) ELLIPSOID.',/)00003760
         READ(0,*) BNOT                                                 00003770
         WRITE(0,241) BNOT
241      FORMAT(' ',/,6X,'B=',F7.3,/)
64    CONTINUE
C-------CALCULATE GEOCENTRIC X,Y,Z-------------------------------------C
      AAXIS    = ANOT+6.378D+6
      BAXIS    = BNOT+6.356D+6
      PHI = REDUCE (PSTN(1) , PSTN(2) , PSTN(3))
      XLM = REDUCE (PSTN(4) , PSTN(5) , PSTN(6))
      CALL DGEOCA (X,Y,Z, AAXIS , BAXIS , PHI
     +                , XLM , PSTN(7))
C-------RECEIVER TYPE--------------------------------------------------C00000960
      WRITE(0,200)                                                      00000970
200   FORMAT(' ','RECIEVER TYPE:',/,2X,'1   CMA-722',/,1X,'*2   JMR',/,200000980
     1X,'3   CMA-751 (FORMAT III DATA)',/,2X,'4   CM9TMJV (CMA-722 TWO D00000990
     2ECIMAL DOPPLER)',/,2X,'5   3M CM (CMA-722 MAGNETIC TAPE FORMAT)',/00001000
     3,1X,'*6   MX1502 (RAW BINARY DATA ONLY)',/,2X,'7   CMA-751 (FORMAT00001010
     4 I DATA)',/,2X,'8   MX1502 (EBCDIC HEXIDECIMAL DATA)')            00001020
      WRITE(0,201)                                                      00001030
201   FORMAT(//,1X,'*: JMR AND MX1502 (RAW BINARY FORMAT) ARE THE RECIEV00001040
     1ERS USED BY THE WISP',/,4X,'PROJECT.  DEFAULT IS 6 (PRESS ENTER KE00001050
     2Y FOR DEFAULT).',/)                                               00001060
      READ(0,202) IRCV                                                  00001070
202   FORMAT(I1)                                                        00001080
      IF(IRCV.LT.1) IRCV=6                                              00001090
      GOTO(31,32,33,34,35,36,37,38),IRCV
31       WRITE(0,203)                                                   00001120
203      FORMAT(' ',/,6X,'1   CMA-722',/)                               00001130
         GOTO 39
32       WRITE(0,2031)
2031     FORMAT(' ',/,6X,'2   JMR',/)
         CALL WRTMVT                                                    00000350
         GOTO 39
33       WRITE(0,2032)
2032     FORMAT(' ',/,6X,'3   CMA-751 (FORMAT III DATA)',/)
         GOTO 39
34       WRITE(0,2033)
2033     FORMAT(' ',/,6X,'4   CM9TMJV (CMA-722 TWO DECIMAL DOPPLER DATA
     1)',/)
         GOTO 39
35       WRITE(0,2034)
2034     FORMAT(' ',/,6X,'5   3M CM (CMA-722 MAGNETIC TAPE FORMAT)',/)
         GOTO 39
36       WRITE(0,2035)
2035     FORMAT(' ',/,6X,'6   MX1502 (RAW BINARY DATA ONLY)',/)
         GOTO 39
37       WRITE(0,2036)
2036     FORMAT(' ',/,6X,'7   CMA-751 (FORMAT I DATA)',/)
         GOTO 39
38       WRITE(0,2037)
2037     FORMAT(' ',/,6X,'8   MX1502 (EBCDIC HEXIDECIMAL DATA)',/)
39    CONTINUE
      IRCV=IRCV-1                                                       00001140
C------METEORLOGIC DATA UNTS SELECTOR----------------------------------C00001150
      WRITE(0,204)                                                      00001160
204   FORMAT(' ','METEORLOGICAL DATA UNITS SELECTOR:',/,3X,'M  METRIC UN00001170
     1ITS',/,3X,'F  ENGLISH UNITS',/,3X,'DEFAULT  NO METEORLOGIC DATA'
     2,/)                                                               00001180
      READ(0,205) IMET                                                  00001190
205   FORMAT(A1)                                                        00001200
      IF(IMET.EQ.TMM) GOTO 43                                           00001210
      WRITE(0,206) IMET                                                 00001220
206   FORMAT(' ',/,6X,A1,/)                                             00001230
C--------INPUT THE NUMBER OF MET. OBSERVATIONS-------------------------C00001270
      WRITE(0,250)						    
250   FORMAT(' ','INPUT METEORLOGIC DATA FROM:',/,6X,'1   FROM THE KEYBO
     1ARD. (DEFAULT)',/,6X,'2   FROM A FILE.',/)
      READ(*,*) METDAT
      IF(METDAT.LT.1) METDAT=1
      GOTO(4001,4002),METDAT
4001     WRITE(0,4011) 
4011     FORMAT(' ',/,6X,'1   FROM THE KEYBOARD.',/)
         GOTO 4003
4002     WRITE(0,4012)
4012     FORMAT(' ',/,6X,'2   FROM A FILE.',/)
4003  CONTINUE
      GOTO (40,41),METDAT
40       WRITE(0,300)                                                   00001280
300      FORMAT(' ','TYPE IN THE NUMBER OF METEORLOGIC OBSERVATIONS THAT
     1 WERE TAKEN.',/)                                                  00001300
         READ(0,*) NUMMET                                               00001310
         WRITE(0,301) NUMMET                                            00001320
301      FORMAT(' ',/,6X,I3,/)                                          00001330
         DO 30 I=1,NUMMET                                               00001340
C--------INPUT MET. DATA OBSERVATION TIME *HOUR OF THE DAY*------------C00001350
            WRITE(0,302) I                                              00001360
302         FORMAT(' ','TYPE IN THE METEORLOGIC DATA OBSERVATION TIME #'
     1,I3,'  (HOUR OF THE DAY)',/)
            READ(0,*) K(I)                                              00001390
            IF(K(I).LE.9) THEN                                          00001400
               WRITE(0,303) K(I)                                        00001410
303            FORMAT(' ',/,6X,I1,/)                                    00001420
            ELSE                                                        00001430
               WRITE(0,304) K(I)                                        00001440
304            FORMAT(' ',/,6X,I2,/)                                    00001450
            ENDIF                                                       00001460
C--------INPUT MET. DATA OBSERVATION TIME *MINUTE OF THE HOUR*---------C00001470
            WRITE(0,305) I                                              00001480
305         FORMAT(' ','TYPE IN THE METEORLOGIC DATA OBSERVATION TIME #'
     1,I3,'  (MINUTE OF THE HOUR)',/)                                   00001500
            READ(0,*) M(I)                                              00001510
            IF(M(I).LE.9) THEN                                          00001520
               WRITE(0,306) M(I)                                        00001530
306            FORMAT(' ',/,6X,I1,/)                                    00001540
            ELSE                                                        00001550
               WRITE(0,307) M(I)                                        00001560
307            FORMAT(' ',/,6X,I2,/)                                    00001570
            ENDIF                                                       00001580
C-------INPUT MET. DATA OBSERVATION TIME *U.T. DAY OF THE YEAR*--------C00001590
            WRITE(0,308) I                                              00001600
308         FORMAT(' ','TYPE IN THE METEORLOGIC DATA OBSERVATION TIME #'
     1,I3,'  (DAY U.T. DAY OF THE YEAR)',/)                             00001620
            READ(0,*) J(I)                                              00001630
            WRITE(0,309) J(I)                                           00001640
309         FORMAT(' ',/,6X,I3,/)                                       00001650
C-------INPUT BAROMETRIC PRESSURE--------------------------------------C00001660
            WRITE(0,310) I                                              00001670
310         FORMAT(' ','TYPE IN THE BAROMETRIC PRESSURE FOR OBSERVATION 
     1#',I3,/)
            READ(0,*) PRES(I)                                           00001690
            WRITE(0,311) PRES(I)                                        00001700
311         FORMAT(' ',/,6X,F5.0,/)                                     00001710
C-------INPUT DRY BULB TEMPERATURE-------------------------------------C00001720
            WRITE(0,312) I                                              00001730
312         FORMAT(' ','TYPE IN THE DRY BULB TEMPERATURE FOR OBSERVATION
     1 #',I3,/)
            READ(0,*) TDRY(I)                                           00001760
            WRITE(0,313) TDRY(I)                                        00001770
313         FORMAT(' ',/,6X,F5.1,/)                                     00001780
C-------INPUT WET BULB TEMPERATURE-------------------------------------C00001790
            WRITE(0,314) I                                              00001800
314         FORMAT(' ','TYPE IN THE WET BULB TEMPERATURE FOR OBSERVATION
     1 #',I3,/)                                                         00001820
            READ(0,*) TWET(I)                                           00001830
            WRITE(0,315) TWET(I)                                        00001840
315         FORMAT(' ',/,6X,F4.1,/)                                     00001850
C-------INPUT RELATIVE HUMIDITY----------------------------------------C00001860
            WRITE(0,316) I                                              00001870
316         FORMAT(' ','TYPE IN THE RELATIVE HUMIDITY IN PERCENT FOR OBS
     1ERVATION # ',I2,/,1X,'IF GREATER THAN ZERO, THIS WILL OVER RIDE TH
     1E USE OF THE WET AND DRY BULB',/,1X,'TEMPERATURES.  IF GREATER THA
     1N 100%, IT IS RESET TO 99%.',/)                                   00001910
            READ(0,*) IRH(I)                                            00001920
            IF(IRH(I).GT.100) IRH(I)=99                                 00001930
            WRITE(0,317) IRH(I)                                         00001940
317         FORMAT(' ',/,6X,I3,/)                                       00001950
30       CONTINUE
         GOTO 43
C-------INPUT MET. DAT FROM A FILE-------------------------------------C
41    WRITE(0,252)						 
252      FORMAT(' ','INPUT THE FILE NAME (INCLUDE THE EXTENSION)',/)
         READ(0,253) METFIL
253      FORMAT(A30)
         WRITE(0,2531) METFIL
2531     FORMAT(' ',/,6X,A30,/)
         OPEN(1,FILE=METFIL,STATUS='OLD')
         NUMMET=0
         I=1
254      READ(1,255,END=42) K(I),M(I),J(I),PRES(I),TDRY(I),TWET(I),
     1                      IRH(I)
255      FORMAT(I2,1X,I2,1X,I3,1X,D6.1,1X,D5.1,1X,D4.1,1X,I3)
         NUMMET=NUMMET+1
         I=I+1
		GOTO 254
42       CONTINUE
43    CONTINUE
      CALL WRTPRE                                                       00001970
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC00000010
C                                                                      C00000020
C       *INTERACTIVE MERGE*       (11/27/87) (MAINFRAME)               C00000030
C                                 (11/24/89) (IBM PC-AT)               C
C                                                                      C00000040
C       THIS SECTION OF THE PROGRAM CREATES THE INPUT FILE TO RUN THE  C
C       MERGE SOFTWARE PROGRAM OF THE GEODOP V SYSTEM.  THE EXECUTION  C
C       OF THIS PROGRAM WILL PROMPT THE USER TO INPUT DATA FROM THE    C
C       KEYBOARD.  THE DATA IS WRITTEN TO THE FILE *ME.INP, SO THAT    C
C       FILE CAN BE SUBMITTED TO EXECUTE THE MERGE SOFTWARE PROGRAM.   C00000100
C          THE NMERGE SOFTWARE PROGRAM HAS TWO MODES:                  C00000110
C          A) COMBINING PREDOP-LIKE SITE FILES INTO ONE LARGE FILE SO  C00000120
C             GEODOP CAN PERFORM A MULTISTATION SHORT ARC CALCULATION. C00000130
C          B) SUBSTITUTE PRECISE EPHEMERIS ORBITS FOR BROADCAST        C00000140
C             EPHEMERIS ORBITS.                                        C00000150
C       MERGE CAN EDIT DATA IN TERMS OF TIME: AT THE BEGINING AND      C00000160
C       ENDING OF THE RECORDING PERIOD.  IN OTHER WORDS, IT CAN DELETE C00000170
C       SEGMENTS OF TIME AT THE BEGINING AND ENDING OF THE RECORDING   C00000180
C       PERIOD.  IN ADDITION, DURING MULTISTATION COMBINING, PASSES    C00000190
C       FROM CERTAIN SATELLITES CAN BE DELETED.                        C00000200
C          THIS IS THE IBM PC-AT VERSION OF THE MAINFRAME PROGRAM.     C
C       THIS PROGRAM HAS BEEN ALTERED SO IT CAN ONLY PROCESS THE       C
C       TRANSIT DATA IN THE POINT POSITIONING MODE.                    C
C          ALL OF THE VARIABLE NAMES USED FOR WRITING TO THE MERGE     C
C       INPUT FILE CORRESPOND TO THE INTERNAL VARIABLE NAMES IN        C
C       THE MERGE FORTRAN SOURCE CODE (SEE REFERENCE BELOW)            C
C          THIS PROGRAM HAS BEEN INCORPORATED INTO THE INTERACTIVE     C
C       PREDOP (IBM PC-AT VERSION)                                     C
C                                                                      C00000210
C       REFERENCES:                                                    C00000220
C          1.  ARCHINAL, B.A., 1986.  DOCUMENTATION FOR THE IBM        C00000230
C                VERSION OF THE GEODOP V PROGRAM SYSTEM, VERSION 2.0.  C00000240
C                UNPUBLISHED.  DEPARTMENT OF GEODETIC SCIENCE AND      C00000250
C                SURVEYING.                                            C00000260
C                                                                      C00000270
C         2. KOUBA, J. AND J.D. BOAL.  1976.  PROGRAM GEODOP.          C
C              DEPARTMENT OF ENERGY, MINES AND RESOURCES, OTTAWA,      C
C              ONTARIO. (N.B.: NOW A PART OF THE CANADIAN GEOLOGIC     C
C              SURVEY)                                                 C
C                                                                      C
C       JAMES MCDONALD                                                 C00000280
C       BYRD POLAR RESEARCH CENTER                                     C00000290
C       O.S.U.                                                         C00000300
C       COLUMBUS, OHIO  43210                                          C00000310
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC00000320
C-------INPUT MODE-----------------------------------------------------C00000630
      WRITE(0,504)                                                      00000640
504   FORMAT(' ','MODE',/,1X,'0  BROADCAST EPHEMERIS (PRESS ENTRY FOR DE
     1FAULT)',/,1X,'1  PRECISE EPHEMERIS',/)                            00000660
      READ(0,505) ISWT                                                  00000670
505   FORMAT(I1)                                                        00000680
      ISWT=ISWT+1
      GOTO(5051,5052),ISWT
5051     WRITE(0,506)                                                   00000690
506      FORMAT(' ',/,6X,'0  BROADCAST EPHEMERIS',/)                    00000700
         GOTO 5053
5052     WRITE(0,5061)
5061     FORMAT(' ',/,6X,'1  PRECISE EPHEMERIS',/)
5053  CONTINUE
      NUMSAT=0
C-------DECISION FOR MERGING PRECISE EPHEMERIS WITH A SITE-------------C00000720
      GOTO (56,54),ISWT                                                 00000730
C-------INPUT PRECISE EPHEMERIS FILE NAME------------------------------C00000840
54       CONTINUE
         WRITE(0,600)
600      FORMAT(' ','INPUT THE NUMBER OF PRECISE EPHEMERIS SATELLITES',/
     1)
         READ(*,*) NUMSAT
         WRITE(0,6001) NUMSAT
6001     FORMAT(' ',/,6X,I1,/)
         DO 20 II=1,NUMSAT
            WRITE(0,510)                                                00000850
510         FORMAT(' ','PRECISE EPHEMERIS FILE NAME (INCLUDE THE EXTENSI
     1ON)',/)                                                           00000860
            READ(0,511) PENAME(II)                                      00000870
511         FORMAT(A30)                                                 00000880
            WRITE(0,512) PENAME(II)                                     00000890
512         FORMAT(' ',/,6X,A30,/)                                      00000900
20       CONTINUE                                                       00001070
C-------TIME EDITING OPTIONS FOR DELETING PASSES-----------------------C00001090
C-------START OF TIME PERIOD *U.T. DAY OF THE YEAR*--------------------C00001110
         WRITE(0,517)                                                   00001120
517      FORMAT(' ','START OF THE TIME PERIOD (DAY OF YEAR, 0-366)',/)  00001130
         READ(0,*) ILIM(3)                                              00001140
         WRITE(0,518) ILIM(3)                                           00001150
518      FORMAT(' ',/,6X,I3,/)                                          00001160
C-------START OF TIME PERIOD *HOUR OF THE DAY*-------------------------C00001170
         WRITE(0,519)                                                   00001180
519      FORMAT(' ','START OF THE TIME PERIOD (HOUR OF DAY, 0-23)',/)   00001190
         READ(0,*) ILIM(4)                                              00001200
         WRITE(0,520) ILIM(4)                                           00001210
520      FORMAT(' ',/,6X,I2,/)                                          00001220
C-------END OF TIME PERIOD *U.T. DAY OF THE YEAR*----------------------C00001230
         WRITE(0,521)                                                   00001240
521      FORMAT(' ','END OF THE TIME PERIOD (DAY OF YEAR, 0-366)',/)    00001250
         READ(0,*) ILIM(5)                                              00001260
         WRITE(0,522) ILIM(5)                                           00001270
522      FORMAT(' ',/,6X,I3,/)                                          00001280
C-------END OF TIME PERIOD *HOUR OF THE DAY*---------------------------C00001290
         WRITE(0,523)                                                   00001300
523      FORMAT(' ','END OF THE TIME PERIOD (HOUR OF DAY, 0-23)',/)     00001310
         READ(0,*) ILIM(6)                                              00001320
         WRITE(0,524) ILIM(6)                                           00001330
524      FORMAT(' ',/,6X,I2,/)                                          00001340
C-------DELETE SATELLITE NUMBERS---------------------------------------C00001460
         WRITE(0,528)                                                   00001470
528      FORMAT(' ','FIRST SATELLITE NUMBER TO BE EXCLUDED')            00001480
         WRITE(0,529)                                                   00001490
529      FORMAT(' ','USE TWO DIGETS FOR THE SATELLITE NUMBER',/,1X,'PRES
     1S ENTER FOR THE DEFAULT',/)                                       00001510
         READ(0,530) KSAT(1)                                            00001520
530      FORMAT(I2)                                                     00001530
         IF(KSAT(1).EQ.0) GOTO 11                                       00001540
            WRITE(0,531) KSAT(1)                                        00001550
531         FORMAT(' ',/,6X,I2,/)                                       00001560
            WRITE(0,532)                                                00001570
532         FORMAT(' ','SECOND SATELLITE NUMBER TO BE EXCLUDED',/)      00001580
            WRITE(0,529)                                                00001590
            READ(0,533) KSAT(2)                                         00001600
533         FORMAT(I2)                                                  00001610
            WRITE(0,531) KSAT(2)                                        00001620
            WRITE(0,534)                                                00001630
534         FORMAT(' ','THIRD SATELLITE NUMBER TO BE EXCLUDED',/)       00001640
            WRITE(0,529)                                                00001650
            READ(0,535) KSAT(3)                                         00001660
535         FORMAT(I2)                                                  00001670
            WRITE(0,531) KSAT(3)                                        00001680
            WRITE(0,536)                                                00001690
536         FORMAT(' ','FORTH SATELLITE NUMBER TO BE EXCLUDED',/)       00001700
            WRITE(0,529)                                                00001710
            READ(0,537) KSAT(4)                                         00001720
537         FORMAT(I2)                                                  00001730
            WRITE(0,531) KSAT(4)                                        00001740
            WRITE(0,538)                                                00001750
538         FORMAT(' ','FIFTH SATELLITE NUMBER TO BE EXCLUDED',/)       00001760
            WRITE(0,529)                                                00001770
            READ(0,539) KSAT(5)                                         00001780
539         FORMAT(I2)                                                  00001790
            WRITE(0,531) KSAT(5)                                        00001800
            WRITE(0,540)                                                00001810
540         FORMAT(' ','SIXTH SATELLITE NUMBER TO BE EXCLUDED',/)       00001820
            WRITE(0,529)                                                00001830
            READ(0,541) KSAT(6)                                         00001840
541         FORMAT(I2)                                                  00001850
            WRITE(0,531) KSAT(6)                                        00001860
11       CONTINUE                                                       00001870
         CALL WRTMER                                                    00001880
56    CONTINUE
      CALL SCR
      STOP                                                              00001980
      END                                                               00001990
      SUBROUTINE WRTPRE                                                 00002000
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC00002010
C                                                                      C00002020
C       *SUBROUTINE WRTPRE*      (11/27/87) (MAINFRAME)                C00002030
C                                (11/24/89) (IBM PC-AT)                C
C                                                                      C00002040
C       THIS SUBROUTINE WRITES INPUT PARAMETERS FOR THE PROGRAM        C
C       PREDOP.EXE TO THE FILE *PR.INP                                 C00002060
C                                                                      C00002070
C       JAMES MCDONALD                                                 C00002080
C       BYRD POLAR RESEARCH CENTER                                     C00002090
C       O.S.U.                                                         C00002100
C       COLUMBUS, OHIO  43210                                          C00002110
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC00002120
      IMPLICIT REAL*8(A-H,O-Z)
      CHARACTER*1 ISTN
      CHARACTER*4 IMET,LOCT                                             00000330
      CHARACTER*30 INPTPR,INPTMR,OTPTPR,INDATA,PENAME
      COMMON /A/ ISTN(30),PSTN(7),NUMMET,IRCV,TIME,IMET,CDOP,CELV,SIGC
      COMMON /B/ SIGF,ANOT,BNOT,K(1000),M(1000),J(1000),TDRY(1000)
      COMMON /C/ TWET(1000),IRH(1000),PRES(1000),LOCT,INPTPR,INPTMR
      COMMON /D/ OTPTPR,INDATA,X,Y,Z,PENAME(17),NUMSAT,ILIM(6),ISWT,
     4           KSAT(6),PHI,XLM
      OPEN(4,FILE=INPTPR,STATUS='NEW')
      WRITE(4,600) INDATA,OTPTPR,(ISTN(I),I=1,30)
600   FORMAT(A30,/,'GEODOP.BIN',/,A30,////,30A1,/)
      WRITE(4,707) (PSTN(I),I=1,7)                                      00002490
707   FORMAT(2(F5.0,1X,F4.0,1X,F8.3,/),3X,F7.2)                         00002500
      WRITE(4,708) IRCV
708   FORMAT('0 0 0',/,'9',/,I1,/,'0',/,'0',/,'0',/,'5',/,'10',/,'1000',
     1/,'50',/,'1')
      WRITE(4,709) ANOT,BNOT
709   FORMAT(F7.3)
      WRITE(4,710)
710   FORMAT('0',/,'0',/,'0 0',/,'11',/,'5')
C-------WITHOUT METEOROLOGIC DATA--------------------------------------C00002680
      IF(IMET.EQ.LOCT) THEN                                             00002690
         WRITE(4,711)                                                   00002700
711      FORMAT('N')                                                    00002710
C-------WITH METEOROLOGIC DATA-----------------------------------------C00002720
      ELSE                                                              00002730
         WRITE(4,712) IMET                                              00002740
712      FORMAT('Y',/,A4,/)                                             00002750
         DO 11 I=1,NUMMET                                               00002800
            ITWET=IDINT(TWET(I)*10)                                     00002810
11          WRITE(4,713) K(I),M(I),J(I),PRES(I),TDRY(I),ITWET,IRH(I)    00002820
713         FORMAT(2(I2,1X),I3,1X,F5.0,1X,F5.1,2(1X,I3))                00002830
      ENDIF                                                             00002840
      CLOSE(4)
      RETURN                                                            00002870
      END                                                               00002880
      SUBROUTINE WRTMER                                                 00001910
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC00001920
C                                                                      C00001930
C       *SUBROUTINE WRTMER*       (11/27/87) (MAINFRAME)               C00001940
C                                 (11/24/89) (IBM PC-AT)               C
C                                                                      C00001950
C       THIS SUBROUTINE WRITES THE INPUT PARAMETERS FOR THE PROGRAM    C
C       MERGE.EXE TO THE FILE *MR.INP.                                 C00001970
C                                                                      C00001980
C       JAMES MCDONALD                                                 C00001990
C       BYRD POLAR RESEARCH CENTER                                     C00002000
C       O.S.U.                                                         C00002010
C       COLUMBUS, OHIO  43210                                          C00002020
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC00002030
      IMPLICIT REAL*8(A-H,O-Z)
      CHARACTER*1 ISTN
      CHARACTER*4 IMET,LOCT                                             00000330
      CHARACTER*30 INPTPR,INPTMR,OTPTPR,INDATA,PENAME
      COMMON /A/ ISTN(30),PSTN(7),NUMMET,IRCV,TIME,IMET,CDOP,CELV,SIGC
      COMMON /B/ SIGF,ANOT,BNOT,K(1000),M(1000),J(1000),TDRY(1000)
      COMMON /C/ TWET(1000),IRH(1000),PRES(1000),LOCT,INPTPR,INPTMR
      COMMON /D/ OTPTPR,INDATA,X,Y,Z,PENAME(17),NUMSAT,ILIM(6),ISWT,
     4           KSAT(6),PHI,XLM
      OPEN(2,FILE=INPTMR,STATUS='NEW')
      WRITE(2,700)
700   FORMAT('MERGQ.BIN',/,'MERGE.SC1',/,'MERGE.SC2')
      DO 10 I=1,NUMSAT+1
         WRITE(2,704) I
704      FORMAT('GEODOP',I1,'.BIN')
10    CONTINUE
      WRITE(2,701) (ILIM(I),I=3,6)
701   FORMAT('1',/,2(I3,1X,I2,1X),/,'N',/,'Y')
      WRITE(2,702) (PENAME(II),II=1,NUMSAT)
702   FORMAT(A30)
      WRITE(2,703) (KSAT(LL),LL=1,6)
703   FORMAT(6(I2,1X))
      WRITE(2,705) 
705   FORMAT('GEODOP.BIN')
      DO 11 I=1,NUMSAT
         WRITE(2,704) I
11    CONTINUE
      CLOSE(2)
      RETURN                                                            00002540
      END                                                               00002550
      SUBROUTINE DGEOCA (X,Y,Z,A,B,ALAT,ALONG,H)
      IMPLICIT REAL*8 (A-H,O-Z)
C
C   VERSION: 01/10/83                  GEODOP IV+V   (JUL81)
C   MODIFIED FOR RUNNING ON IBM FORTRAN (G1 OR Q COMPILERS).
C   B. ARCHINAL, DEPT. OF GEODETIC SCIENCE AND SURVEYING,
C   THE OHIO STATE UNIVERSITY, COLUMBUS, OHIO.
C
C     THIS SUBROUTINE IS IN DOUBLE PRECISION.
C     THIS SUBROUTINE CONVERTS GEODITIC COORD. INTO CARTISIAN COORD.
C     X,Y,Z_ARE THE CARTESIAN COORDINATE(OUT_PUT).
C     A AND ESQ_ARE THE ELEMENTS OF ELLIPSOID AS IN_PUT.
C     ALAT,ALONG,H_ARE THE LATITUDE ,LONGITUDE,H RESP. AS  IN_PUT.
      ESQ=(A*A-B*B)/(A*A)
      DENSQ=1.D0-ESQ*DSIN(ALAT)**2
      DEN=DSQRT(DENSQ)
      RAD=A/DEN
      X=(RAD+H)*DCOS(ALAT)*DCOS(ALONG)
      Y=(RAD+H)*DCOS(ALAT)*DSIN(ALONG)
      Z=(RAD*(1.D0-ESQ)+H)*DSIN(ALAT)
      RETURN
      END
      FUNCTION REDUCE (A,B,C)
      IMPLICIT REAL*8 (A-H,O-Z)
C
C   VERSION: 10/05/82                  GEODOP IV+V   (JUL81)
C   MODIFIED FOR RUNNING ON IBM FORTRAN (G1 OR Q COMPILERS).
C   B. ARCHINAL, DEPT. OF GEODETIC SCIENCE AND SURVEYING,
C   THE OHIO STATE UNIVERSITY, COLUMBUS, OHIO.
C
C   NO SUBPROGRAMS CALLED.
C
C
C        "REDUCE    " - AUTHOR        - P.G. LAWNIKANIS
C                     - WRITTEN ON    - SUMMER /74.
C                     - LAST COMPILED - APRIL   1975.
C                     - REFERENCES    - *NONE*
C
C         VARIABLES USED     -A       ,B       ,C       ,
C
C         VARIABLES ALTERED  -REDUCE  ,        ,        ,
C
C         VARIABLES RETURNED -REDUCE  ,        ,        ,
C
C         EXTERNAL ROUTINES  -*NONE*  ,        ,        ,
C
C         I/O DEVICES        -*NONE*  ,        ,        ,
C
C
      REDUCE=(A +(B +C/.600000000D 02)/.6000000000D 02)*.1745329252D-01
      RETURN
      END
      SUBROUTINE SCR
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
C                                                                      C
C       *SUBROUTINE SCR*     (11/26/89)                                C
C                                                                      C
C       THIS SUBROUTINE WRITES DATA TO THE SCRATCH FILES               C
C                                                                      C
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
      IMPLICIT REAL*8(A-H,O-Z)
      CHARACTER*1 ISTN
      CHARACTER*2 ORBIT(2)
      CHARACTER*4 IMET,LOCT                                             00000330
      CHARACTER*30 INPTPR,INPTMR,OTPTPR,INDATA,PENAME
      COMMON /A/ ISTN(30),PSTN(7),NUMMET,IRCV,TIME,IMET,CDOP,CELV,SIGC
      COMMON /B/ SIGF,ANOT,BNOT,K(1000),M(1000),J(1000),TDRY(1000)
      COMMON /C/ TWET(1000),IRH(1000),PRES(1000),LOCT,INPTPR,INPTMR
      COMMON /D/ OTPTPR,INDATA,X,Y,Z,PENAME(17),NUMSAT,ILIM(6),ISWT,
     4           KSAT(6),PHI,XLM
      DATA ORBIT/'BE','PE'/
      OPEN(3,FILE='GEODOP3.SCR',STATUS='NEW')
      WRITE(3,704) NUMSAT
704   FORMAT(I1)
      CLOSE(3)
      OPEN(5,FILE='GEODOP1.SCR',STATUS='NEW')
      WRITE(5,705) (ISTN(I),I=1,30),ORBIT(ISWT),X,Y,Z,ANOT,BNOT
705   FORMAT('1',/,30A1,/,A2,/,3(F11.2,1X),/,2(F7.3,1X))
      CLOSE(5)
      OPEN(9,FILE='GEODOP4.SCR',STATUS='NEW')
      PSTN(2)=ABS(PSTN(2))
      PSTN(3)=ABS(PSTN(3))
      XLM=XLM/.1745329252D-01
      XNEWLN=360.D0+XLM
      IM2=IDINT(XNEWLN)
      PSTN(4)=FLOAT(IM2)
      IN2=IDINT((XNEWLN-PSTN(4))*60.D0)
      PSTN(5)=FLOAT(IN2)
      PSTN(6)=(((XNEWLN-PSTN(4))*60.D0)-PSTN(5))*60.D0
      WRITE(9,706) (PSTN(KK),KK=1,7),X,Y,Z
706   FORMAT(2(F5.0,1X,F4.0,1X,F8.3,/),F7.2,/,3(F11.1,/))
      RETURN
      END
      SUBROUTINE WRTMVT                                                 00000380
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC00000390
C                                                                      C00000400
C       *SUBROUTINE WRTMVT*       (11/28/87) (MAINFRAME)               C00000410
C                                 (11/24/89) (IBM PC-AT)               C
C                                                                      C00000420
C          THIS SUBROUTINE WRITES DATA TO THE FILE MJVOTE.INP.  THIS   C
C       FILE IS USED BY THE PROGRAM VOTEJMR.EXE (CANADIAN GEOLOGIC     C
C       SURVEY, MODIFIED AND TRANSFERED TO THE PC-AT BY JAMES          C
C       MCDONALD) TO MAJORITY VOTE THE JMR SATELLITE RECEIVER DATA.    C
C       THE MAJORITY VOTED DATA IS THEN RUN THROUGH PREDOP.            C
C                                                                      C
C       JAMES MCDONALD                                                 C00000460
C       BYRD POLAR RESEARCH CENTER                                     C00000470
C       O.S.U.                                                         C00000480
C       COLUMBUS, OHIO  43210                                          C00000490
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC00000500
      IMPLICIT REAL*8(A-H,O-Z)
      CHARACTER*1 ISTN,PRFILE(6),MRFILE(6),OTFILE(6),BIN(6),DES,TEST
      CHARACTER*4 IMET,TMM,LOCT                                         00000330
      CHARACTER*30 INPTPR,INPTMR,OTPTPR,INDATA,PENAME,METFIL
      COMMON /A/ ISTN(30),PSTN(7),NUMMET,IRCV,TIME,IMET,CDOP,CELV,SIGC
      COMMON /B/ SIGF,ANOT,BNOT,K(1000),M(1000),J(1000),TDRY(1000)
      COMMON /C/ TWET(1000),IRH(1000),PRES(1000),LOCT,INPTPR,INPTMR
      COMMON /D/ OTPTPR,INDATA,X,Y,Z,PENAME(17),NUMSAT,ILIM(6),ISWT,
     4           KSAT(6),PHI,XLM
      OPEN(11,FILE='MJVOTE.INP',STATUS='NEW')
      WRITE(11,207) (ISTN(I),I=1,30)                                    00000790
207   FORMAT(4X,'1',/,'JMR DATA',/,4X,'0',4X,'5',4X,'6',
     14X,'0',4X,'2',4X,'8',4X,'9',4X,'7',4X,'0',4X,'1',4X,'0',/
     2,30A1,/,4X,'1')                                                   00000810
      WRITE(11,205)                                                     00000630
205   FORMAT(4X,'1',4X,'0',4X,'0',4X,'1')                               00000640
      RETURN                                                            00000840
      END                                                               00000850
